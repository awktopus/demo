<mat-toolbar color="primary">
  <h4> EVERLEAGUES EZsign Guest Portal </h4>
</mat-toolbar>
<div *ngIf="mycase" style="background:#eeeeff">
  <table width=95%>
    <tr>
      <td valign=top>
        <font color="a0a0a0" size=-1>Tracking #</font>
        <br>
        <b>
          {{mycase.ezSignTrackingId}}
        </b>
      </td>
      <td valign=top>
        <font color="a0a0a0" size=-1>Sender Name</font>
        <br>
        <b>
          {{mycase.senderName}}
        </b>
      </td>
      <td valign=top>
        <font color="a0a0a0" size=-1>Document Name</font>
        <br>
        <b>
          {{mycase.displayName}}
        </b>
      </td>
      <td valign=top>
        <font color="a0a0a0" size=-1>Signers</font>
        <br>
        <span *ngFor='let usr of mycase.ezSignDocSigners'>
          <b>
            {{usr.receiverFirstName}} {{usr.receiverLastName}}
          </b>
          <br>
        </span>
      </td>
      <td valign=top>
        <font color="a0a0a0" size=-1>Status</font>
        <br>
        <b>
          {{mycase.status}}
        </b>
      </td>
      <td *ngIf="mycase.status != 'Signed' && mycase.status != 'Presigned' && viewType != 'finalview'" valign=top>
        <font color="a0a0a0" size=-1># Page(s) to Sign</font>
        <br>
        <span>
          <b>
            {{pageToSign}}
          </b>
          <br>
        </span>
      </td>
      <td *ngIf="mycase.status != 'Signed' && mycase.status != 'Presigned' && viewType != 'finalview'" valign=top>
        <font color="a0a0a0" size=-1>Page Seq #</font>
        <br>
        <span>
          <b>
            {{curseq}}
          </b>
          <br>
        </span>
      </td>
      <td valign=top>
        <font color="a0a0a0" size=-1>Date</font>
        <br>
        <b>{{mycase.lastModifiedDateTime}}</b>
      </td>
    </tr>
  </table>
  <hr>
</div>

<div class="content" *ngIf="mycase != null && mycase.status == 'Signed'" 
style="background:#eeeeff">
  <hr>
  <p>
  </p> 
    <table width=90%>
    <tr>
      <td align=center>
        <font size=+2 color=green>
          <br>
          <br> You have signed the document. Click "Download" to download the signed document.
        </font>
        <br>
        <br>     
        <button mat-raised-button color="primary" (click)="downloadEzSignDocument()">Download</button>
        </td>
    </tr>
    <tr>
      <br/>
    </tr>
  </table>
</div>

<div *ngIf="viewType == 'consentview'" class="consent" style="word-break:break-word;white-space:normal !important;">
  <table width=98%>
    <tr>
      <td align="center">
        <p>
          <strong>EZSign Consent</strong>
        </p>
        <hr>
      </td>
    </tr>
    <tr>
      <td>
        <p>
          <b>Check the checkbox indicating your consent to sign this document electronically and click “BEGIN” when you are
            ready to begin the e-sign process.</b>
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <p>
          By checking the checkbox below, I agree that my electronic signatures on the following document are my own and are legally
          valid as if I had signed the document with ink on paper, in accordance with the Electronic Signatures in Global
          and National Commerce Act (E-SIGN) of 2000 and the Uniform Electronic Transactions Act (UETA).
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <mat-checkbox (change)="agreementselected=!agreementselected">I have read and agree to the above.</mat-checkbox>
      </td>
    </tr>
    <br/>
    <tr>
      <td align="center">
        <!-- <a routerLink="/" style="color: black" *ngIf="selected"> -->
        <button mat-raised-button color="accent" *ngIf="agreementselected" (click)="completeConsent()">BEGIN</button>
      </td>
    </tr>
    <tr>
      <br/>
    </tr>
  </table>
</div>
<div *ngIf="viewType=='signingFormView' || viewType=='signcapview'" #pdfviewcontainer class='casedoc' style="word-break:break-word;white-space:normal !important;">
  <div *ngFor="let fld of curpage.filterFields" style="position:absolute;z-index:90;background:#ccccff;border:1pt solid green"
    [style.bottom.px]="fld.adjustposY-1" [style.left.px]="fld.adjustPosX+1">
    <table style="padding-top:2pt" [style.background-color]="fld.bgcolor">
      <tr>
        <td>
          <img src="/assets/imgs/bookmark.png" width=24> </td>
        <td>
          <b>{{fld.fieldTypeName}} </b>- {{fld.labelName}}</td>
        <td width=5></td>
        <td>
          <mat-checkbox [checked]="fld.picked" [value]="fld.fieldSeqNo" (change)="pickField($event)"></mat-checkbox>
        </td>
      </tr>
    </table>
  </div>
  <pdf-viewer [original-size]="true" [src]="pdfUrl" (page-rendered)="pageRendered($event)"></pdf-viewer>

</div>
<div *ngIf="viewType=='signcapview'" class='signcapcls' style="word-break:break-word;white-space:normal !important;">
  <form [formGroup]="signcapform">
    <table width=95%>
      <div *ngFor='let field of curpage.filterFields'>
        <tr [style.background-color]="field.bgcolor">

          <td>
            <div *ngIf='field.fieldTypeName=="Signature"'>
              <font color="#33699">Please sign below as:
                <br>
                <b>{{cursigner.receiverFullName}}</b>
              </font>
              <br>
              <div style="border:1px solid">
                <signature-pad [options]="signaturePadOptions" id="{{field.eleId}}"></signature-pad>
              </div>
              <div align='end' style="margin-right:20pt">
                <button align="right" small mat-icon-button color="primary" (click)='clearSigCap(field)' *ngIf='field.fieldTypeName=="Signature"'>
                  <mat-icon>refresh</mat-icon> clear
                </button>
              </div>
            </div>
            <mat-form-field *ngIf='field.fieldTypeName=="Initial" || field.fieldTypeName=="Text" '>
              <mat-label>{{field.labelName}}</mat-label>
              <input matInput placeholder={{field.labelName}} formControlName="{{field.eleId}}">
            </mat-form-field>
            <mat-form-field *ngIf='field.fieldTypeName=="Date"'>
              <mat-label>{{field.labelName}}</mat-label>
              <input matInput [matDatepicker]="picker" formControlName="{{field.eleId}}">
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </td>
          <td valign=top>
            <br>
            <mat-checkbox [checked]="field.picked" [value]="field.fieldSeqNo" (change)="pickField($event)"></mat-checkbox>
          </td>
        </tr>
      </div>
<tr>
  <br/>
</tr>
      <tr>
        <td>
          <span *ngIf='!showProcessSpinner'>
            <table>
              <tr>
                <td *ngIf='curpage.presignstatus'>
                  <button mat-raised-button color="accent" (click)="viewPreSignPage()">View</button>
                  &nbsp;
                </td>
               
                <td *ngIf='curpage.presignstatus'>
                  <button mat-raised-button color="accent" (click)="SkipPage()">Next</button>
                  &nbsp;
                </td>
                
                <td *ngIf='curpage.presignstatus'>
                  <button mat-raised-button color="accent" (click)="submitSignCapData()">Update</button>
                  &nbsp;
                </td>
             
                <td *ngIf='!curpage.presignstatus'>
                  <button mat-raised-button color="accent" (click)="submitSignCapData()">Save</button>
                </td>
   
              </tr>
            </table>
          </span>
          <mat-spinner *ngIf='showProcessSpinner' diameter='30'></mat-spinner>
          <span *ngIf='showProcessSpinner'>Processing...</span>
        </td>
      </tr>
    </table>
  </form>
</div>
<div *ngIf="viewType=='finalview'" class='signcapcls' style="word-break:break-word;white-space:normal !important;">
  <font color=green>Please review and submit the signed document.</font>

  <table width=80%>
    <tr>
      <br/>
    </tr>
    <tr>
      <td>
        <span *ngIf='!showReviewSpinner'>
          <button mat-raised-button color="accent" (click)="previewDoc()">Review</button>
        </span>
        <mat-spinner *ngIf='showReviewSpinner' diameter='40'></mat-spinner>
        <span *ngIf='showReviewSpinner'>Processing...</span>
        &nbsp;&nbsp;&nbsp;
        <span *ngIf='!showSubmitSpinner'>
          <button mat-raised-button color="accent" (click)="finalizeSigning()">Submit</button>
        </span>
        <mat-spinner *ngIf='showSubmitSpinner' diameter='40'></mat-spinner>
        <span *ngIf='showSubmitSpinner'>Processing...</span>
      </td>
    </tr>
  </table>
</div>