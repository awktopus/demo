<table>
    <tr>
        <th>
            <label class="heading-label">EZSign</label>
        </th>
    </tr>
</table>
<div>
    <mat-spinner *ngIf='!isEZsignDataFetched' diameter='30'></mat-spinner>
    <span *ngIf='!isEZsignDataFetched'>Processing...</span>
</div>
<br>
<mat-tab-group (focusChange)="changeTab($event)" #myTabGroup [selectedIndex]="selectedIndex">
    <mat-tab>
        <ng-template mat-tab-label>
            Send Documents
        </ng-template>
        <br/>
        <table width=90% *ngIf='isEZsignDataFetched'>
            <tr>
                <td width=45%>
                    <button *ngIf="ezSignDocsgridData" mat-raised-button color="accent" matTooltip="Create new ezsign document" (click)="launchNewEZSignDocument()">
                        <mat-icon>note_add</mat-icon>&nbsp;EZSIGN DOCUMENT
                    </button>
                </td>
                <td align=right>
                    <div *ngIf="ezSignDocsgridData && isEZsignDataFetched">
                        <mat-icon class='docicon' mdbRippleRadius matTooltip="Config Columns" (click)='openColumnConfig(ezsignapi)'>list_alt</mat-icon>
                        <mat-icon class='docicon' mdbRippleRadius (click)="gridExport('ezsign')" matTooltip="Export CSV">insert_link</mat-icon>
                        <mat-icon class='docicon' mdbRippleRadius (click)="resizeAll('ezsign')" matTooltip="Expand All">swap_horiz</mat-icon>
                        <mat-icon class='docicon' mdbRippleRadius (click)="fitsizeAll('ezsign')" matTooltip="Refit">tune</mat-icon>
                    </div>
                </td>
            </tr>
        </table>

        <div *ngIf="!ezSignDocsgridData && isEZsignDataFetched">
            <table class="trackertable">
                <tr align="center">
                    <td colspan="12">
                        <label class="heading-label">Start Sending PDF Document for Signing</label>
                        <hr>
                    </td>
                </tr>
                <tr>
                    <td colspan="12">
                        <mat-horizontal-stepper labelPosition="bottom" [linear]="isLinear" #stepper #eZSignWFStepper="matHorizontalStepper">

                            <mat-step completed="true" editable="false">
                                <ng-template matStepLabel matStepperIcon="edit">
                                    <mat-icon>insert_drive_file</mat-icon>
                                    <br>
                                    <strong>Upload Document</strong>
                                    <br> Upload PDF document to send for signing</ng-template>
                            </mat-step>
                            <mat-step>
                                <ng-template matStepLabel matStepperIcon="edit">
                                    <mat-icon>group</mat-icon>
                                    <br>
                                    <strong>Add Signers</strong>
                                    <br/> Add signers by their email addresses</ng-template>
                            </mat-step>
                            <mat-step>
                                <ng-template matStepLabel matStepperIcon="edit">
                                    <mat-icon>list_alt</mat-icon>
                                    <br>
                                    <strong>Add Fields</strong>
                                    <br> Add fields (signature,date,text) in document</ng-template>
                            </mat-step>
                            <mat-step>
                                <ng-template matStepLabel matStepperIcon="edit">
                                    <mat-icon>mail</mat-icon>
                                    <br>
                                    <strong>Send Invites</strong>
                                    <br> Review and send invites for signing the document</ng-template>
                            </mat-step>
                        </mat-horizontal-stepper>
                    </td>
                </tr>
                <tr>
                    <td colspan="12">
                        <!-- <div>
                            <table>
                                <tr>
                                    <td>
                                        <label class="heading-label">Create New EZSign Document</label>
                                        <hr>
                                    </td>
                                </tr>
                            </table>
                        </div> -->
                        <div class="uploadfilecontainer" (click)="fileInput.click()" appDragDrop (onFileDropped)="uploadFile($event)">
                            <label class="heading-label">Drag and drop or Upload PDF document here</label>
                            <input hidden type="file" #fileInput (change)="uploadFile($event.target.files)">
                        </div>
                        <div class="files-list" *ngFor="let file of files;let i=index">
                            <p>{{ file.name }}</p>
                            <button class="delete-file" (click)="deleteAttachment(i)">
                                <img src="../../../../assets/imgs/Recycle_Bin_Full.png">
                            </button>
                        </div>
                        <div>
                            <span *ngIf='!showProcessSpinner'>
                                    <button *ngIf="files.length != 0" mat-raised-button color="accent" matTooltip="Create new ezsign document" (click)="createNewEZSignDocument()">
                                        + NEW EZSIGN DOCUMENT
                                    </button>
                                </span>
                                <mat-spinner *ngIf='showProcessSpinner' diameter='40'></mat-spinner>
                                <span *ngIf='showProcessSpinner'>Processing...</span>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <br/>
        <div style="margin-left: 1px;margin-right: 1px" *ngIf="ezSignDocsgridData && isEZsignDataFetched">
            <!-- <br>
            <table width=99%>
                <tr>
                    <td align=left>
                    </td>
                    <td align=right>
                        <mat-icon class='docicon' mdbRippleRadius matTooltip="Config Columns" (click)='openColumnConfig(ezsignapi)'>list_alt</mat-icon>
                        <mat-icon class='docicon' mdbRippleRadius (click)="gridExport('ezsign')" matTooltip="Export CSV">insert_link</mat-icon>
                        <mat-icon class='docicon' mdbRippleRadius (click)="resizeAll('ezsign')" matTooltip="Expand All">swap_horiz</mat-icon>
                        <mat-icon class='docicon' mdbRippleRadius (click)="fitsizeAll('ezsign')" matTooltip="Refit">tune</mat-icon>
                    </td>
                </tr>
            </table> -->
            <ag-grid-angular #agGrid id="ezSignDocsGrid" style="width: 100%;  font-size:11pt" class="ag-theme-balham" [rowData]="ezSignDocsgridData"
                [enableSorting]="true" [statusBar]="statusBar" [enableFilter]="true" [columnDefs]="gridColumnDefs" [enableColResize]="true"
                [pagination]="true" [paginationPageSize]="20" [frameworkComponents]="frameworkComponents" [context]="context"
                (firstDataRendered)="onFirstDataRendered($event,'ezsign')" [rowHeight]="rowHeight" [rowClass]="rowClass" [domLayout]="domLayout">
            </ag-grid-angular>
        </div>
    </mat-tab>

    <!-- <mat-tab>
        <ng-template mat-tab-label>
            Received Documents
        </ng-template>
    </mat-tab> -->
</mat-tab-group>